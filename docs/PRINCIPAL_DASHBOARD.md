# Principal Dashboard - ูพูู ูุฏุฑุงู ูุฏุฑุณู

## ููุง ฺฉู (Overview)

ูพูู ูุฏุฑุงู ฺฉ ุฏุงุดุจูุฑุฏ ุงุฎุชุตุงุต ุจุฑุง ูุฏุฑุงู ูุฑ ูุฏุฑุณู ุงุณุช ฺฉู ุจู ุขูโูุง ุงูฺฉุงู ูโุฏูุฏ:

- ูุฏุฑุช ฺฉูุงุณโูุง
- ูุฏุฑุช ูุนููุงู
- ูุฏุฑุช ุฏุงูุดโุขููุฒุงู
- ูุฏุฑุช ุงููุงุก

## ุณุงุฎุชุงุฑ ุณุณุชู

### 1. ููุดโูุง ฺฉุงุฑุจุฑ (User Roles)

ุณุณุชู ุงุฒ **ฺฉ ุฌุฏูู users** ุจุฑุง ููู ฺฉุงุฑุจุฑุงู ุงุณุชูุงุฏู ูโฺฉูุฏ ุจุง ููุดโูุง ูุฎุชูู:

```sql
CREATE TYPE user_role AS ENUM (
  'school_admin',  -- ูุฏุฑ ุณุณุชู (ุณููพุฑ ุงุฏูู)
  'principal',     -- ูุฏุฑ ูุฏุฑุณู
  'teacher',       -- ูุนูู
  'student',       -- ุฏุงูุดโุขููุฒ
  'parent'         -- ูู
);
```

### 2. ุฌุฏูู Users

ููู ฺฉุงุฑุจุฑุงู ุฏุฑ ฺฉ ุฌุฏูู ุจุง `school_id` ุฐุฎุฑู ูโุดููุฏ:

```sql
CREATE TABLE users (
  id UUID PRIMARY KEY,
  school_id UUID REFERENCES schools(id),  -- ๐ด ุงูุฒุงู ุจุฑุง ููู
  email VARCHAR(255),
  phone VARCHAR(20),
  national_id VARCHAR(10),
  password_hash VARCHAR(255),
  name VARCHAR(255),
  role user_role NOT NULL,
  profile JSONB DEFAULT '{}'::jsonb,
  is_active BOOLEAN DEFAULT true,
  last_login TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### ูฺฺฏโูุง ูุฑ ููุด:

| ููุด (Role)     | school_id   | ูุฑูุฏ ุจุง                | ูุณุฆููุชโูุง                          |
| -------------- | ----------- | ---------------------- | ----------------------------------- |
| `school_admin` | โ Required | Phone OTP / Email      | ูุฏุฑุช ูุฏุงุฑุณ ู ูุฏุฑุงู               |
| `principal`    | โ Required | Phone OTP              | ูุฏุฑุช ฺฉูุงุณโูุงุ ูุนููุงูุ ุฏุงูุดโุขููุฒุงู |
| `teacher`      | โ Required | Phone OTP              | ุชุฏุฑุณ ู ุขุฒูููโุณุงุฒ                  |
| `student`      | โ Required | National ID + Password | ุดุฑฺฉุช ุฏุฑ ุขุฒูููโูุง                    |
| `parent`       | โ Required | Phone OTP              | ูุดุงูุฏู ุนููฺฉุฑุฏ ูุฑุฒูุฏ                 |

### 3. ูุนูุงุฑ ุฏุณุชุฑุณ

```
ุณููพุฑ ุงุฏูู (school_admin)
    โ
    โโโโ ูุฏุฑุณู 1
    โ    โโโโ ูุฏุฑ 1 (principal)
    โ    โ    โโโโ ฺฉูุงุณโูุง
    โ    โ    โโโโ ูุนููุงู
    โ    โ    โโโโ ุฏุงูุดโุขููุฒุงู
    โ    โ    โโโโ ุงููุงุก
    โ    โ
    โ    โโโโ ูุฏุฑ 2 (principal)
    โ         โโโโ ...
    โ
    โโโโ ูุฏุฑุณู 2
         โโโโ ูุฏุฑ 3 (principal)
              โโโโ ...
```

## ุฏุงุดุจูุฑุฏ ูุฏุฑุงู

### ูุณุฑ ุฏุณุชุฑุณ

```
http://localhost:3000/principal
```

### ุตูุญุงุช ููุฌูุฏ

| ูุณุฑ                  | ุชูุถุญุงุช                       |
| --------------------- | ----------------------------- |
| `/principal`          | ุตูุญู ุงุตู ุฏุงุดุจูุฑุฏ ุจุง ุขูุงุฑ ฺฉู |
| `/principal/classes`  | ูุฏุฑุช ฺฉูุงุณโูุง                |
| `/principal/teachers` | ูุฏุฑุช ูุนููุงู                 |
| `/principal/students` | ูุฏุฑุช ุฏุงูุดโุขููุฒุงู            |
| `/principal/parents`  | ูุฏุฑุช ุงููุงุก                 |
| `/principal/settings` | ุชูุธูุงุช                       |

### ูฺฺฏโูุง ุฏุงุดุจูุฑุฏ

#### 1. ููุงุฑ ุจุงูุง (Top Navigation)

- ููฺฏู ุณุณุชู
- ูุงู ูุฏุฑ
- ุฏฺฉูู ุฎุฑูุฌ

#### 2. ููู ฺฉูุงุฑ (Sidebar)

- ุฏุงุดุจูุฑุฏ
- ฺฉูุงุณโูุง
- ูุนููุงู
- ุฏุงูุดโุขููุฒุงู
- ุงููุงุก
- ุชูุธูุงุช

#### 3. ุขูุงุฑ ฺฉู (Stats Cards)

- ุชุนุฏุงุฏ ฺฉูุงุณโูุง
- ุชุนุฏุงุฏ ูุนููุงู
- ุชุนุฏุงุฏ ุฏุงูุดโุขููุฒุงู
- ุชุนุฏุงุฏ ุงููุงุก

#### 4. ุงูุฏุงูุงุช ุณุฑุน (Quick Actions)

- ุงูุฒูุฏู ฺฉูุงุณ ุฌุฏุฏ
- ุงูุฒูุฏู ูุนูู ุฌุฏุฏ
- ุงูุฒูุฏู ุฏุงูุดโุขููุฒ ุฌุฏุฏ

## ุงุญุฑุงุฒ ููุช ูุฏุฑุงู

### ูุฑูุฏ ูุฏุฑุงู

ูุฏุฑุงู ูุงููุฏ ูุนููุงู ุจุง **ุดูุงุฑู ููุฑุงู ู OTP** ูุงุฑุฏ ูโุดููุฏ:

1. ูุฏุฑ ุจู ุตูุญู ูุฑูุฏ ูโุฑูุฏ
2. ุชุจ "๐ฑ ูุฏุฑ / ูุนูู / ูู" ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ
3. ุดูุงุฑู ููุจุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ูโฺฉูุฏ
4. ฺฉุฏ OTP ุฑุง ุฏุฑุงูุช ู ูุงุฑุฏ ูโฺฉูุฏ
5. ุจู ูพูู ูุฏุฑุช ูุฏุงุช ูโุดูุฏ

### ฺฉูุชุฑู ุฏุณุชุฑุณ

```typescript
// ุฏุฑ layout.tsx
const checkAuth = async () => {
  const response = await fetch("/api/auth/me");
  const data = await response.json();

  // ุจุฑุฑุณ ููุด ฺฉุงุฑุจุฑ
  if (data.user.role !== "principal") {
    router.push("/dashboard"); // ูุฏุงุช ุจู ุฏุงุดุจูุฑุฏ ุนููู
    return;
  }

  setUser(data.user);
};
```

## API Endpoints

### GET `/api/principal/dashboard`

ุฏุฑุงูุช ุขูุงุฑ ฺฉู ูุฏุฑุณู

**Request Headers:**

```
Cookie: user_session=...
```

**Response:**

```json
{
  "schoolName": "ุฏุจุฑุณุชุงู ุดูุฏ ุจูุดุช",
  "stats": {
    "totalClasses": 12,
    "totalTeachers": 25,
    "totalStudents": 300,
    "totalParents": 250
  }
}
```

### GET `/api/principal/classes`

ุฏุฑุงูุช ูุณุช ฺฉูุงุณโูุง ูุฏุฑุณู

### POST `/api/principal/classes`

ุงุฌุงุฏ ฺฉูุงุณ ุฌุฏุฏ

### GET `/api/principal/teachers`

ุฏุฑุงูุช ูุณุช ูุนููุงู ูุฏุฑุณู

### POST `/api/principal/teachers`

ุงูุฒูุฏู ูุนูู ุฌุฏุฏ

### GET `/api/principal/students`

ุฏุฑุงูุช ูุณุช ุฏุงูุดโุขููุฒุงู ูุฏุฑุณู

### POST `/api/principal/students`

ุงูุฒูุฏู ุฏุงูุดโุขููุฒ ุฌุฏุฏ

## ุฑุงูโุงูุฏุงุฒ ู ุงุณุชูุงุฏู

### 1. ุงุฌุงุฏ ูุฏุฑ ุจุฑุง ูุฏุฑุณู

```sql
-- ุงูุฒูุฏู ูุฏุฑ ุจู ุนููุงู user ุจุง ููุด principal
INSERT INTO users (
  id,
  school_id,
  phone,
  name,
  role,
  is_active,
  created_at
) VALUES (
  gen_random_uuid(),
  'school_uuid_here',     -- ID ูุฏุฑุณู
  '09121234567',           -- ุดูุงุฑู ููุจุงู ูุฏุฑ
  'ุนู ุงุญูุฏ',            -- ูุงู ูุฏุฑ
  'principal',             -- ููุด: ูุฏุฑ ูุฏุฑุณู
  true,
  NOW()
);
```

### 2. ูุฑูุฏ ุจู ูพูู ูุฏุฑุช

```
1. ุฑูุชู ุจู ุตูุญู ูุฑูุฏ: http://localhost:3000/signin
2. ุงูุชุฎุงุจ ุชุจ "๐ฑ ูุฏุฑ / ูุนูู / ูู"
3. ูุงุฑุฏ ฺฉุฑุฏู ุดูุงุฑู ููุจุงู: 09121234567
4. ุฏุฑุงูุช ู ูุงุฑุฏ ฺฉุฑุฏู ฺฉุฏ OTP
5. ุฎูุฏฺฉุงุฑ ุจู /principal ูุฏุงุช ูโุดูุฏ
```

### 3. ูุฏุฑุช ฺฉุงุฑุจุฑุงู

#### ุงูุฒูุฏู ูุนูู:

```sql
INSERT INTO users (school_id, phone, name, role)
VALUES ('school_uuid', '09123456789', 'ูุญูุฏ ุฑุถุง', 'teacher');
```

#### ุงูุฒูุฏู ุฏุงูุดโุขููุฒ:

```sql
INSERT INTO users (school_id, national_id, password_hash, name, role)
VALUES (
  'school_uuid',
  '1234567890',
  '$2a$12$hashed_password',
  'ุฒูุฑุง ฺฉุฑู',
  'student'
);
```

#### ุงูุฒูุฏู ูู:

```sql
INSERT INTO users (school_id, phone, name, role)
VALUES ('school_uuid', '09129999999', 'ูุงุทูู ุงุญูุฏ', 'parent');

-- ุงุฑุชุจุงุท ูู ุจุง ุฏุงูุดโุขููุฒ
INSERT INTO parent_student_relations (parent_id, student_id, relationship)
VALUES ('parent_uuid', 'student_uuid', 'mother');
```

## ุงููุช

### ฺฉูุชุฑู ุฏุณุชุฑุณ

- ููู APIูุง principal ุจุฑุฑุณ ูโฺฉููุฏ ฺฉู ฺฉุงุฑุจุฑ ููุด `principal` ุฏุงุฑุฏ
- ููู ุนููุงุช ููุท ุฑู ุฏุงุฏูโูุง ูุฏุฑุณู ุฎูุฏ ฺฉุงุฑุจุฑ ุงูุฌุงู ูโุดูุฏ
- ุงุณุชูุงุฏู ุงุฒ `school_id` ุฏุฑ ุชูุงู ฺฉูุฆุฑโูุง ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ

```typescript
// ูุซุงู ฺฉูุชุฑู ุฏุณุชุฑุณ
if (user.role !== "principal") {
  return NextResponse.json({ error: "ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ" }, { status: 403 });
}

// ููุท ุฏุงุฏูโูุง ูุฏุฑุณู ุฎูุฏ
const classes = await client.query(
  "SELECT * FROM classes WHERE school_id = $1",
  [user.school_id]
);
```

## ุชูุงูุช ุจุง ุฌุฏูู principals ูุฏู

### โ ูุจูุงู (ุฌุฏูู ุฌุฏุงฺฏุงูู):

```sql
-- ุฌุฏูู ุฌุฏุงฺฏุงูู ุจุฑุง principals
CREATE TABLE principals (
  id UUID PRIMARY KEY,
  school_id UUID,
  name VARCHAR(255),
  phone VARCHAR(20),
  is_active BOOLEAN
);

-- + ุฌุฏูู users
```

ูุดฺฉูุงุช:

- ุชฺฉุฑุงุฑ ุฏุงุฏู
- ูพฺุฏฺฏ ุฏุฑ ุงุญุฑุงุฒ ููุช
- ูุงุฒ ุจู join ุฏุฑ ฺฉูุฆุฑโูุง

### โ ุญุงูุง (ฺฉ ุฌุฏูู users):

```sql
-- ููุท ฺฉ ุฌุฏูู ุจุง role
CREATE TABLE users (
  id UUID PRIMARY KEY,
  school_id UUID,
  name VARCHAR(255),
  phone VARCHAR(20),
  role user_role,  -- 'principal', 'teacher', etc.
  ...
);
```

ูุฒุงุง:

- ุณุงุฏูโุชุฑ ู ููุทูโุชุฑ
- ุงุญุฑุงุฒ ููุช ฺฉูพุงุฑฺู
- ฺฉูุฆุฑโูุง ุณุงุฏูโุชุฑ
- ูุฏุฑุช ุขุณุงูโุชุฑ

## Migration Script

ุจุฑุง ุงูุชูุงู ุงุฒ ุฌุฏูู ูุฏู:

```sql
-- ุงูุชูุงู principals ุจู users
INSERT INTO users (
  school_id,
  phone,
  name,
  role,
  is_active,
  created_at,
  updated_at
)
SELECT
  school_id,
  phone,
  name,
  'principal'::user_role,
  is_active,
  created_at,
  updated_at
FROM principals
WHERE id NOT IN (SELECT id FROM users WHERE role = 'principal');

-- ุญุฐู ุฌุฏูู ูุฏู (ุงุฎุชุงุฑ)
-- DROP TABLE principals;
```

## UI Components

### 1. Stats Card

```tsx
<div className="bg-white rounded-2xl p-6 border">
  <div className="flex items-center justify-between">
    <div>
      <p className="text-sm text-slate-600">ฺฉูุงุณโูุง</p>
      <p className="text-3xl font-bold">12</p>
    </div>
    <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-blue-600">
      <Icon />
    </div>
  </div>
</div>
```

### 2. Quick Action Button

```tsx
<Link href="/principal/classes/new">
  <div className="border-2 border-dashed hover:border-blue-500">
    <Icon />
    <div>
      <p>ุงูุฒูุฏู ฺฉูุงุณ ุฌุฏุฏ</p>
      <p className="text-xs">ุงุฌุงุฏ ฺฉูุงุณ ุฏุฑุณ ุฌุฏุฏ</p>
    </div>
  </div>
</Link>
```

## ูุณุฑ ุชูุณุนู ุขูุฏู

### ูุงุฒ 1 (ูุนู) โ

- [x] ุฏุงุดุจูุฑุฏ ุงุตู ูุฏุฑุงู
- [x] ุงุญุฑุงุฒ ููุช ุจุง Phone OTP
- [x] ููุงุด ุขูุงุฑ ฺฉู
- [ ] ูุฏุฑุช ฺฉูุงุณโูุง
- [ ] ูุฏุฑุช ูุนููุงู
- [ ] ูุฏุฑุช ุฏุงูุดโุขููุฒุงู
- [ ] ูุฏุฑุช ุงููุงุก

### ูุงุฒ 2 (ุขูุฏู)

- [ ] ฺฏุฒุงุฑุดโูุง ุชูุตู
- [ ] ูููุฏุงุฑูุง ู ุขูุงุฑูุง
- [ ] ุงุฑุชุจุงุท ุจุง ุงููุงุก
- [ ] ูุฏุฑุช ุจุฑูุงูู ฺฉูุงุณ
- [ ] ูุฏุฑุช ุบุจุช ู ุญุถูุฑ
- [ ] ุตุฏูุฑ ฺฉุงุฑูุงูู

### ูุงุฒ 3 (ุขูุฏู)

- [ ] ฺฉูพุงุฑฺูโุณุงุฒ ุจุง ุณุณุชูโูุง ุฏฺฏุฑ
- [ ] ุงูพูฺฉุดู ููุจุงู
- [ ] ุงุนูุงูโูุง ููุดููุฏ
- [ ] ุชุญูู ุฏุงุฏู ุจุง AI

## ูพุดุชุจุงู ู ุฑุงูููุง

### ุณูุงูุงุช ูุชุฏุงูู

**Q: ฺฺฏููู ูุฏุฑ ุฌุฏุฏ ุงุฌุงุฏ ฺฉููุ**
A: ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุฆุฑ SQL ุฏุฑ ุจุฎุด "ุฑุงูโุงูุฏุงุฒ ู ุงุณุชูุงุฏู"

**Q: ุขุง ฺฉ ูุฏุฑุณู ูโุชูุงูุฏ ฺูุฏ ูุฏุฑ ุฏุงุดุชู ุจุงุดุฏุ**
A: ุจููุ ูโุชูุงูุฏ ฺูุฏู user ุจุง role='principal' ู ฺฉ school_id ุงุฌุงุฏ ฺฉูุฏ

**Q: ุชูุงูุช principal ุจุง school_admin ฺุณุชุ**
A:

- `school_admin`: ูุฏุฑ ฺฉู ุณุณุชูุ ูุฏุฑุช ููู ูุฏุงุฑุณ
- `principal`: ูุฏุฑ ฺฉ ูุฏุฑุณู ุฎุงุตุ ููุท ูุฏุฑุช ูุฏุฑุณู ุฎูุฏ

**Q: ฺฺฏููู ูุฏุฑ ุฑุง ุงุฒ ฺฉ ูุฏุฑุณู ุจู ูุฏุฑุณู ุฏฺฏุฑ ููุชูู ฺฉููุ**
A:

```sql
UPDATE users
SET school_id = 'new_school_uuid'
WHERE id = 'principal_uuid';
```

## ุชุณุช ุณุณุชู

```bash
# 1. ุงุฌุงุฏ ูุฏุฑ ุชุณุช
psql -d your_db -c "
INSERT INTO users (school_id, phone, name, role)
VALUES (
  (SELECT id FROM schools LIMIT 1),
  '09121111111',
  'ูุฏุฑ ุชุณุช',
  'principal'
);
"

# 2. ูุฑูุฏ ุจู ุณุณุชู
# ุฑูุชู ุจู http://localhost:3000/signin
# ูุงุฑุฏ ฺฉุฑุฏู ุดูุงุฑู: 09121111111
# ูุงุฑุฏ ฺฉุฑุฏู OTP ุงุฒ console
# ูุฏุงุช ุจู /principal

# 3. ุจุฑุฑุณ ุฏุงุดุจูุฑุฏ
# ุจุงุฏ ุขูุงุฑ ุตุญุญ ููุงุด ุฏุงุฏู ุดูุฏ
```

## ุฎูุงุตู

โ **ูุฏุฑุงู (principals)** ุงฺฉููู ุจุฎุด ุงุฒ ุฌุฏูู **users** ูุณุชูุฏ
โ ููู ฺฉุงุฑุจุฑุงู ุฏุงุฑุง **school_id** ูุณุชูุฏ
โ ูุฏุฑุงู ุจุง **Phone OTP** ูุงุฑุฏ ูโุดููุฏ
โ ุฏุงุดุจูุฑุฏ ุงุฎุชุตุงุต ุจุง ุขูุงุฑ ู ูุฏุฑุช ฺฉุงูู
โ ฺฉูุชุฑู ุฏุณุชุฑุณ ุงูู ุจุฑ ุงุณุงุณ ููุด ู ูุฏุฑุณู

**ุณุณุชู ุขูุงุฏู ุงุณุชูุงุฏู ู ุชูุณุนู ุงุณุช!** ๐
